<%
base_path = "/u/#{@target_user.handle}/settings/webhooks/#{@webhook.truncated_id}"
-%>
# Webhook: <%= @webhook.name %>

## Details

| Field | Value |
|-------|-------|
| URL | `<%= @webhook.url %>` |
| Status | <%= @webhook.enabled? ? "Enabled" : "Disabled" %> |
| Events | <%= @webhook.events.join(", ") %> |
| Secret | `<%= @webhook.secret.first(8) %>...` (partial) |
| Created | <%= @webhook.created_at.strftime("%Y-%m-%d %H:%M") %> |

## Recent Deliveries

<% if @recent_deliveries.empty? -%>
No deliveries yet.
<% else -%>
| Event | Status | Response | Attempts | Time |
|-------|--------|----------|----------|------|
<% @recent_deliveries.each do |delivery| -%>
<% event = @events_by_id[delivery.event_id] -%>
| `<%= event&.event_type || "unknown" %>` | <%= delivery.status %> | <%= delivery.response_code || (delivery.error_message ? truncate(delivery.error_message, length: 30) : "-") %> | <%= delivery.attempt_count %> | <%= time_ago_in_words(delivery.created_at) %> ago |
<% end -%>
<% end -%>

## Navigation

* [All Webhooks](/u/<%= @target_user.handle %>/settings/webhooks)
<% if @target_user == @current_user -%>
* [Settings](/settings)
<% else -%>
* [<%= @target_user.handle %>'s Profile](/u/<%= @target_user.handle %>)
<% end -%>
