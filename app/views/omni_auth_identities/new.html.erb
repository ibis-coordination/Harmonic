<link rel="stylesheet" href="<%= asset_path 'registration_form.css' %>">
<script type="module" src="<%= asset_path 'registration_form.js' %>"></script>

<div class="pulse-auth-page">
  <div class="pulse-auth-logo">
    <i class="tri-logo-icon icon-lg"></i>
  </div>

  <h1 class="pulse-auth-title">Create account</h1>

  <p class="pulse-auth-subtitle">
    Create an account on <code class="pulse-code"><%= ENV['HOSTNAME'] %></code>
  </p>

  <% if @identity&.errors&.any? %>
    <div style="background: #fef2f2; border: 1px solid #fecaca; color: #991b1b; padding: 12px 16px; border-radius: 6px; margin-bottom: 16px;">
      <% @identity.errors.full_messages.each do |message| %>
        <p style="margin: 0;"><%= message %></p>
      <% end %>
    </div>
  <% end %>

  <%= form_with url: "/auth/identity/register", method: :post, data: { turbo: false }, id: "registration-form", class: "pulse-auth-form" do |form| %>
    <div id="email-feedback" class="password-feedback"></div>
    <%= form.email_field :email, placeholder: 'Email', required: true, id: 'email-field', class: 'pulse-form-input', value: @identity&.email %>

    <div id="name-feedback" class="password-feedback"></div>
    <%= form.text_field :name, placeholder: 'Name', required: true, id: 'name-field', class: 'pulse-form-input', value: @identity&.name %>

    <div id="password-feedback" class="password-feedback"></div>
    <%= form.password_field :password, placeholder: 'Password (minimum 14 characters)',
        id: 'password-field',
        class: 'pulse-form-input',
        minlength: 14,
        required: true %>

    <div id="password-confirmation-feedback" class="password-feedback"></div>
    <%= form.password_field :password_confirmation, placeholder: 'Confirm password',
        id: 'password-confirmation-field',
        class: 'pulse-form-input',
        minlength: 14,
        required: true %>

    <div class="pulse-form-actions">
      <%= submit_tag "Create account", id: "submit-button", class: "pulse-action-btn", style: "width:100%;", disabled: true %>
    </div>
    <div class="pulse-auth-footer">
      Already have an account? <%= link_to 'Log in', '/login', class: 'pulse-auth-link' %>
    </div>
  <% end %>
</div>
