<%= render 'shared/show_resource_breadcrumbs', resource: nil do %>
  <i class='commitment-icon'></i> Commitment
<% end %>
<div style="height:16px"></div>
<%= form_with do |form| %>
  <div>
    <%= form.text_field :title, placeholder: 'Action that this commitment will initiate' %>
  </div>
  <div style="margin-top:8px;" class="mention-autocomplete-container" data-controller="mention-autocomplete" data-mention-autocomplete-studio-path-value="<%= @current_studio.path %>">
    <%= form.text_area :description, placeholder: 'Description (markdown supported, use @ to mention users)', data: { mention_autocomplete_target: "input" } %>
    <div data-mention-autocomplete-target="dropdown" class="mention-dropdown"></div>
  </div>
  <%= render 'shared/multi_file_select', form: form %>
  <h2>Critical Mass</h2>
  <p>
    At least <%= form.number_field :critical_mass, value: 1, style: 'width:48px;' %> participant(s) required for this commitment to take effect.
  </p>
  <h2>Deadline</h2>
  <p>
    Critical mass must be reached by
  </p>
  <p>
    <%= render 'shared/deadline_input_fields', form: form, deadline: Time.current + 1.week, close_at_critical_mass_option: true %>
  </p>
  <hr style="height:1px;" />
  <%= form.submit 'Start Commitment' %>
  <% if @current_studio.is_scene? %>
    <span>
      <%= octicon 'eye' %>
      Commitments posted in scenes are publicly visible.
    </span>
  <% else %>
    <span>
      <%= octicon 'lock' %>
      Only members of this studio can access this commitment.
    </span>
  <% end %>
<% end %>
