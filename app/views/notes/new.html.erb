<%= render 'shared/pulse_breadcrumb', items: [
  [@current_superagent.name, @current_superagent.path],
  'New'
] %>

<%= render 'shared/pulse_create_tabs', current: :note %>

<article class="pulse-resource-detail">

  <%= form_with(url: "#{@current_superagent.path}/note", class: "pulse-form") do |form| %>
    <div class="pulse-form-group">
      <div class="mention-autocomplete-container" data-controller="mention-autocomplete" data-mention-autocomplete-studio-path-value="<%= @current_superagent.path %>">
        <%= form.text_area :text,
            placeholder: "Write your note here... (use @ to mention users)",
            autofocus: true,
            value: @note.text,
            class: "pulse-form-textarea",
            rows: 8,
            data: { mention_autocomplete_target: "input" } %>
        <div data-mention-autocomplete-target="dropdown" class="mention-dropdown"></div>
      </div>
    </div>

    <%= render 'shared/multi_file_select', form: form %>

    <div class="pulse-form-actions">
      <%= form.submit 'Post Note', class: 'pulse-action-btn' %>
      <span class="pulse-visibility-hint">
        <% if @current_superagent.is_scene? %>
          <%= octicon 'eye', height: 14 %>
          Notes posted in scenes are publicly visible.
        <% else %>
          <%= octicon 'lock', height: 14 %>
          Only members of this studio will see this note.
        <% end %>
      </span>
    </div>
  <% end %>
</article>
