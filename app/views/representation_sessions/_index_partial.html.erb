<% header_level ||= 3 %>
<% if @active_sessions.any? %>
<div class="active-sessions">
  <h<%= header_level %>>Active Sessions</h<%= header_level %>>
  <p>
    <%= @current_superagent.name %> is currently being represented in <%= @active_sessions.count %> active session<%= @active_sessions.count == 1 ? '' : 's' %>.
  </p>
  <ul>
    <% @active_sessions.each do |session| %>
      <li>
        <%= link_to "Session <code>#{session.truncated_id}</code>".html_safe, session.path %>
        <span class="timeago">began <%= timeago(session.began_at) %></span>
      </li>
    <% end %>
  </ul>
</div>
<hr/>
<% end %>

<% if @current_user.superagent_member.can_represent? %>
  <p>
    <a href="<%= @current_superagent.path %>/represent">
      <button>New Session</button>
    </a>
  </p>
<% end %>

<p>Representation allows this studio (<%= @current_superagent.name %>) to act as an individual member of other studios.</p>

<% if @current_superagent.trustee_user.superagents.empty? %>
  <p>
    <%= @current_superagent.name %> is not currently a member of any other studios.
  </p>
<% else %>
  <p>
    <%= @current_superagent.name %> is currently a member of the following studios:
  </p>
  <ul>
    <% @current_superagent.trustee_user.superagents.each do |studio| %>
      <li>
        <%= link_to studio.name, studio.path %>
      </li>
    <% end %>
  </ul>
<% end %>


<h<%= header_level %>>Representatives</h<%= header_level %>>

<p>Representatives act on behalf of <%= @current_superagent.name %> through sessions during which their actions are recorded and made visible here.</p>

<% if @current_superagent.any_member_can_represent? %>
  <p><%= @current_superagent.name %> is configured to allow any member to represent the studio.</p>
<% else %>
  <p><%= @current_superagent.name %> currently has <%= @representatives.count %> representative<%= @representatives.count == 1 ? '' : 's' %>.</p>

  <ul>
    <% @representatives.each do |representative| %>
      <li>
        <%= profile_pic(representative) %>
        <%= link_to representative.display_name, representative.path %>
        <span class="role-badge">representative</span>
      </li>
    <% end %>
  </ul>
<% end %>

<h<%= header_level %>>Representation Sessions</h<%= header_level %>>

<% if @representation_sessions.empty? %>
  <p>
    No sessions have happened yet.
  </p>
<% else %>
  <ul>
    <% @representation_sessions.each do |representation_session| %>
      <li>
        <%= link_to "Session <code>#{representation_session.truncated_id}</code>".html_safe, representation_session.path %>
        <%= representation_session.action_count %> action<%= representation_session.action_count == 1 ? '' : 's' %>,
        <span class="timeago">ended <%= timeago(representation_session.ended_at) %></span>
      </li>
    <% end %>
  </ul>
<% end %>
